%!TEX root=main.tex

% Packages
%
\usetikzlibrary{positioning,calc}

%already included in packages.tex, that is loaded before

\newtoggle{notes}
\toggletrue{notes} % set to false to remove colored notes from the paper

%\newtheorem{assumption}{Assumption}
\newtheorem{paramset}{Parameter Set}
\newtheorem{notation}{Notation}
\newtheorem{observation}{Observation}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Paper specific 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% ----------- Comments -----------
\newcommand{\nikolas}[1]{{\bf \color{teal} [n] #1}}

\newcommand{\gc}[1]{{\bf \color{DarkGreen} [gc] #1}}
\newcommand{\gnote}[1]{{\bf \color{DarkGreen} [gc] #1}}
\newcommand{\GNote}[1]{{\bf \color{DarkGreen} [gc] #1}}
\newcommand{\Gnote}[1]{{\bf \color{DarkGreen} [gc] #1}}
\newcommand{\geoffroy}[1]{{\bf \color{DarkGreen} [gc] #1}}
\newcommand{\Dnote}[1]{\color{blue}[\textbf{Dung}:~{ #1}]\color{black}}


\ifnum\commentson=0
% disable comments 
\renewcommand{\nikolas}[1]{%
  {}
}
\renewcommand{\gc}[1]{%
  {}
}
\renewcommand{\GNote}[1]{%
  {}
}
\renewcommand{\geoffroy}[1]{%
  {}
}
\renewcommand{\Gnote}[1]{%
  {}
}
\renewcommand{\gnote}[1]{%
  {}
}
\fi

%--------------------------------------------------------
% Algorithms
%--------------------------------------------------------

\iffalse
\newaliascnt{algo}{theorem}
%\theoremstyle{definition}
\newtheorem{algo}[algo]{Algorithm}
\aliascntresetthe{algo}
\crefname{algo}{algorithm}{algorithms}

\newenvironment{algorithm}{\begin{mybox} \vspace{-.1in}\begin{algo}}{ \vspace{-.1in} \end{algo}\end{mybox}}
\newenvironment{InlinedAlgorithm}{\begin{algo}}{\end{algo}}
\fi

%--------------------------------------------------------
% Editorial
%--------------------------------------------------------
\newcommand{\comments}[1]{{\textcolor{gray}{// #1}}}

\newcommand{\redunderline}[1]{\textcolor{red}{\underline{\textcolor{black}{#1}}}} 
\newcommand{\TBW}{\textcolor{blue}{\textbf{To Be Written...}}}
\newcommand{\Note}[1]{\textcolor{magenta}{ $\langle \! \langle$ #1 $\rangle \! \rangle$}}
\newcommand{\cn}{{\color{red}\textsuperscript{[cn]}}}

%--------------------------------------------------------
% Specific to this paper
%--------------------------------------------------------

%SS-PRG notations
\newcommand{\EA}{\ensuremath{\mathsf{EA}}\xspace}
\newcommand{\Setup}{\ensuremath{\mathsf{Setup}}\xspace}
\newcommand{\SampleSeed}{\ensuremath{\mathsf{SampleSeed}}\xspace}
\newcommand{\Tss}{\ensuremath{\mathsf{T}_{\mathsf{ss}}}\xspace}
%\newcommand{\PRG}{\ensuremath{\mathsf{PRG}}\xspace}
\newcommand{\seed}{\ensuremath{\mathsf{seed}}\xspace}
\renewcommand{\pp}{\ensuremath{\mathsf{pp}}\xspace}
\newcommand{\gp}{\ensuremath{\mathsf{gp}}\xspace}

%PCGs
\newcommand{\PCG}{\ensuremath{\mathsf{PCG}}\xspace}
\newcommand{\Gen}{\ensuremath{\mathsf{Gen}}\xspace}
\newcommand{\Expand}{\ensuremath{\mathsf{Expand}}\xspace}
\newcommand{\RSample}{\ensuremath{\mathsf{RSample}}\xspace}
\newcommand{\key}{\ensuremath{\mathsf{k}}\xspace}
\newcommand{\pseed}{\rho}
\newcommand{\fprog}{\phi}
\newcommand{\cC}{\mathcal{C}}
\newcommand{\id}{\mathsf{id}}
% \newcommand{\RandomBits}{\mathsf{RandomBits}}
\newcommand{\RandomBits}{\mathsf{PRBits}}

\newcommand{\FSS}{\ensuremath{\mathsf{FSS}}\xspace}
\newcommand{\Leak}{\ensuremath{\mathsf{Leak}}\xspace}
\newcommand{\Real}{\ensuremath{\mathsf{Real}}\xspace}
\newcommand{\Ideal}{\ensuremath{\mathsf{Ideal}}\xspace}
\newcommand{\Weights}{\ensuremath{\mathsf{W}}\xspace}

%Hashing
\newcommand{\Alloc}{\ensuremath{\mathsf{Alloc}}\xspace}
\newcommand{\Load}{\ensuremath{\mathsf{Load}}\xspace}
\newcommand{\Test}{\ensuremath{\mathsf{Test}}\xspace}
\newcommand{\Quality}{\ensuremath{\mathsf{Quality}}\xspace}
\newcommand{\good}{\ensuremath{\mathsf{good}}\xspace}
\newcommand{\Univ}{\ensuremath{\mathbb{U}}\xspace}
\newcommand{\SampleHash}{\ensuremath{\mathsf{SampleHash}}\xspace}
\newcommand{\Func}{\ensuremath{\mathcal{F}}\xspace}

%distributions
\newcommand{\Dist}{\mathcal{D}} % generic
\newcommand{\EDist}{\mathcal{E}} % noise vectors
\newcommand{\NDist}{\mathcal{N}} % noise vectors
\newcommand{\MDist}{\mathcal{M}} % matrices
\newcommand{\WDist}{\mathcal{W}} % sparse matrices where row is uniformly sparse vector
\newcommand{\WDistEA}{\mathcal{A}} % sparse matrices where row is sampled from bernoulli
\newcommand{\SDist}{\mathcal{S}} % sparse vectors
\newcommand{\UDist}{\mathcal{U}} % unit vectors
\newcommand{\Unif}{\mathcal{U}} % uniform vectors
\newcommand{\RDist}{\mathcal{R}} % regular vectors
\newcommand{\XDist}{\mathcal{X}} % xor vectors
\newcommand{\Ber}{\mathcal{B}} % Bernoulli vectors

% various algorithms and notations
%\newcommand{\secpar}{\ensuremath{\lambda}\xspace}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=.1pt] (char) {#1};}}

\newcommand{\one}{\ensuremath{\mathbbm{1}}\xspace}
\newcommand{\err}{\ensuremath{\mathsf{err}}\xspace}
\newcommand{\ctr}{\ensuremath{\mathsf{ctr}}\xspace}
\newcommand{\noise}{\circled{$\mathsf{n}$}\xspace}
%\newcommand{\HW}{\ensuremath{\mathsf{HW}}\xspace}
\newcommand{\Pred}{\ensuremath{\mathsf{P}}\xspace}
\newcommand{\PredF}{\ensuremath{\mathcal{P}}\xspace}
\newcommand{\PredH}{\ensuremath{\mathcal{H}}\xspace}
\newcommand{\Rel}{\ensuremath{\mathsf{Rel}}\xspace}
\newcommand{\Supp}{\ensuremath{\mathsf{Supp}}\xspace}
\newcommand{\W}{\ensuremath{\mathsf{W}}\xspace}
\newcommand{\bias}{\ensuremath{\mathsf{bias}}\xspace}
\newcommand{\cNei}{\ensuremath{\mathsf{N}^{\mathsf{c}}}\xspace}
\newcommand{\Nei}{\ensuremath{\mathsf{N}}\xspace}
%\newcommand{\negl}{\ensuremath{\mathsf{negl}}\xspace}
\newcommand{\dd}{\ensuremath{\mathsf{dd}}\xspace}
\newcommand{\Comp}{\ensuremath{\mathsf{Comp}}\xspace}
\newcommand{\UDec}{\ensuremath{\mathsf{Dec}}\xspace}
\newcommand{\Rec}{\ensuremath{\mathsf{Rec}}\xspace}
\newcommand{\unit}{\ensuremath{\mathsf{unit}}\xspace}
\newcommand{\nzi}{\ensuremath{\mathsf{nzi}}\xspace}
\newcommand{\indist}{\stackrel{\rm c}{\approx}}
\newcommand{\Trans}{\ensuremath{{\intercal}}\xspace}
\newcommand{\SD}{\ensuremath{{\mathsf{SD}}}\xspace}
\newcommand{\LPN}{\ensuremath{{\mathsf{LPN}}}\xspace}
\newcommand{\QASD}{\ensuremath{{\mathsf{QASD}}}\xspace}
\newcommand{\QAEval}{\ensuremath{{\mathsf{QA}\mhyphen\mathsf{Eval}}}\xspace}
\newcommand{\code}[1]{\mathscr{#1}}
\mathchardef\mhyphen="2D
\newcommand{\suchthat}{\ensuremath{\phantom{i}|\phantom{i}}\xspace}
\newcommand{\ct}{\ensuremath{\mathsf{ct}}\xspace}
%% useful shortcuts
\newcommand{\word}[1]{\ensuremath{\boldsymbol{\rm #1}}}
\renewcommand{\vec}[1]{\word{#1}}
\newcommand{\bfa}{\word{a}}
\newcommand{\bfb}{\word{b}}
\newcommand{\bfc}{\word{c}}
\newcommand{\bfe}{\word{e}}
\newcommand{\bfg}{\word{g}}
\newcommand{\bfh}{\word{h}}
\newcommand{\bfk}{\word{k}}
\newcommand{\bfm}{\word{m}}
\newcommand{\bfs}{\word{s}}
\newcommand{\bfu}{\word{u}}
\newcommand{\bfv}{\word{v}}
\newcommand{\bfw}{\word{w}}
\newcommand{\bfx}{\word{x}}
\newcommand{\bfy}{\word{y}}
\newcommand{\bfz}{\word{z}}

\newcommand{\mat}[1]{\ensuremath{\boldsymbol{\rm #1}}}
\newcommand{\bfA}{\mat{A}}
\newcommand{\bfB}{\mat{B}}
\newcommand{\bfC}{\mat{C}}
\newcommand{\bfE}{\mat{E}}
\newcommand{\bfG}{\mat{G}}
\newcommand{\bfH}{\mat{H}}
\newcommand{\bfM}{\mat{M}}
\newcommand{\bfP}{\mat{P}}
\newcommand{\bfS}{\mat{S}}
\newcommand{\bfT}{\mat{T}}
\newcommand{\bfY}{\mat{Y}}
\newcommand{\bfZ}{\mat{Z}}

%--------------------------------------------------------
% General notations
%--------------------------------------------------------


\let\vec\mathbf
%\newcommand{\bit}{\ensuremath{\{0,1\}}\xspace}
\newcommand{\nset}{\ensuremath{\{0,1, \dots, n\}}\xspace}
%\newcommand{\getsr}{\leftarrow_{r}}
\newcommand{\getsr}{\stackrel{\rm \scriptscriptstyle\$}{\gets}}
%\newcommand{\poly}{\ensuremath{\mathsf{poly}}\xspace}

%--------------------------------------------------------
% Standard proba, games, proofs, sampling, distributions
%--------------------------------------------------------

\newcommand{\Good}{\ensuremath{\mathsf{Good}}\xspace}
\newcommand{\Bad}{\ensuremath{\mathsf{Bad}}\xspace}
\newcommand{\equivStat}{\ensuremath{\overset{\mathsf{stat}}{\equiv}}\xspace}
\newcommand{\equivComp}{\ensuremath{\overset{\mathsf{comp}}{\equiv}}\xspace}
%\newcommand{\view}{\ensuremath{\textsc{View}}\xspace}
%\newcommand{\state}{\ensuremath{\mathsf{st}}\xspace}
\newcommand{\st}{\state}
\newcommand{\Hyb}{\ensuremath{\mathsf{Hyb}}\xspace}
%\newcommand{\Exp}{\ensuremath{\mathsf{Exp}}\xspace}
\newcommand{\myGame}{\ensuremath{\mathsf{Game}}\xspace}
\newcommand{\Event}{\ensuremath{\mathsf{E}}\xspace}
\newcommand{\Span}{\ensuremath{\mathsf{Span}}}
%\newcommand{\prob}[1]{{\Pr}\left[\,{#1}\,\right]}
\newcommand{\probb}[2]{{\Pr}_{#1}\left[\,{#2}\,\right]}
\newcommand{\Dx}{\mathcal{D}}
\newcommand{\Hx}{\mathcal{H}}
\newcommand{\Sx}{\mathcal{S}}
\newcommand{\Lx}{\mathcal{L}}
\newcommand{\Fx}{\mathcal{F}}
\DeclareMathOperator*{\Expect}{\ensuremath{\mathbb{E}}\xspace}
\newcommand{\Sample}{\ensuremath{\mathsf{Sample}}\xspace}
\newcommand{\Sim}{\ensuremath{\mathsf{Sim}}\xspace}

%--------------------------------------------------------
% Adversaries, oracles
%--------------------------------------------------------

\newcommand{\AdvA}{\ensuremath{\mathcal{A}}\xspace}
\newcommand{\AdvB}{\ensuremath{\mathcal{B}}\xspace}
\newcommand{\AdvC}{\ensuremath{\mathcal{C}}\xspace}
\newcommand{\AdvD}{\ensuremath{\mathcal{D}}\xspace}

%\newcommand{\adv}{\ensuremath{\mathsf{Adv}}\xspace}
%\newcommand{\oracle}{\ensuremath{\mathcal{O}}\xspace}

%--------------------------------------------------------
% Classes, sets, groups
%--------------------------------------------------------

\newcommand{\BPP}{\ensuremath{\mathsf{BPP}}\xspace}
\newcommand{\NP}{\ensuremath{\mathsf{NP}}\xspace}
\newcommand{\coNP}{\ensuremath{\mathsf{coNP}}\xspace}
\newcommand{\PSPACE}{\ensuremath{\mathsf{PSPACE}}\xspace}
\newcommand{\NC}{\ensuremath{\mathsf{NC}}\xspace}
\newcommand{\NCZ}{\ensuremath{{\mathsf{NC}_0}}\xspace}

% \newcommand{\Z}{\mathbb{Z}}
%\newcommand{\F}{\mathbb{F}}
%\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\G}{\mathbb{G}}
\newcommand{\Gt}{\mathbb{G}_{\mathsf{T}}}
\newcommand{\Hset}{\mathbb{H}}
\newcommand{\Zn}{\mathbb{Z}_n}
\newcommand{\Group}{\mathbb{G}}
\newcommand{\Field}{\mathbb{F}}
\newcommand{\Integers}{\mathbb{Z}}

\newcommand{\Lang}{\ensuremath{\mathscr{L}}}
\newcommand{\Lpar}{\ensuremath{\Lang_{\param}}\xspace}
\newcommand{\setX}{\mathcal{X}}
\newcommand{\setY}{\mathcal{Y}}
%\newcommand{\keyspace}{\mathcal{K}}


%--------------------------------------------------------
% Primitives, algorithms
%--------------------------------------------------------

\newcommand{\proverS}{\ensuremath{\mathsf{P}_{\Sigma}}\xspace}
\newcommand{\verifierS}{\ensuremath{\mathsf{V}_{\Sigma}}\xspace}
\newcommand{\prover}{\ensuremath{\mathsf{P}}\xspace}
\newcommand{\verifier}{\ensuremath{\mathsf{V}}\xspace}
%\newcommand{\sender}{\ensuremath{\mathsf{S}}\xspace}
%\newcommand{\receiver}{\ensuremath{\mathsf{R}}\xspace}
\newcommand{\ZK}{\textsf{ZK}\xspace}
\newcommand{\zk}{\textsf{zk}\xspace}
\newcommand{\HVZK}{\textsf{HVZK}\xspace}
\newcommand{\NIZK}{\hardprobfont{NIZK}\xspace}
\newcommand{\NIZKs}{\hardprobfont{NIZKs}\xspace}
\newcommand{\NIWI}{\hardprobfont{NIWI}\xspace}
\newcommand{\sigmap}{$\Sigma$-protocol\xspace}
\newcommand{\sigmaps}{$\Sigma$-protocols\xspace}
\newcommand{\OT}{\ensuremath{\mathsf{OT}}\xspace}
\newcommand{\OTs}{\ensuremath{\mathsf{OTs}}\xspace}
\newcommand{\Eval}{\ensuremath{\mathsf{Eval}}\xspace}
\newcommand{\Hash}{\ensuremath{\mathsf{H}}\xspace}
\newcommand{\GroupGen}{\textsf{BilinearGen}\xspace}
\newcommand{\DDHGen}{\textsf{DHGen}\xspace}
\newcommand{\PGen}{\textsf{PGen}\xspace}
\newcommand{\KeyGen}{\ensuremath{\mathsf{KeyGen}}\xspace}
\newcommand{\Encode}{\ensuremath{\mathsf{Encode}}\xspace}
\newcommand{\Enc}{\ensuremath{\mathsf{Enc}}\xspace}
\newcommand{\Dec}{\ensuremath{\mathsf{Dec}}\xspace}
\newcommand{\INDCCA}{\ensuremath{\mathsf{IND\text{-}CCA}}\xspace}
\newcommand{\INDCPA}{\ensuremath{\mathsf{IND\text{-}CPA}}\xspace}
\newcommand{\Rand}{\ensuremath{\mathsf{Rand}}\xspace}
\newcommand{\com}{\ensuremath{\mathsf{com}}\xspace}
\newcommand{\Commit}{\ensuremath{\mathsf{Commit}}\xspace}
\newcommand{\Prove}{\ensuremath{\mathsf{Prove}}\xspace}
\newcommand{\prove}{\ensuremath{\mathsf{prove}}\xspace}
\newcommand{\Verify}{\ensuremath{\mathsf{Verify}}\xspace}
\newcommand{\Answer}{\ensuremath{\mathsf{Answer}}\xspace}
\newcommand{\Open}{\ensuremath{\mathsf{Open}}\xspace}
\newcommand{\myproof}{\ensuremath{\vec{\pi}}\xspace}
%\newcommand{\Gen}{\ensuremath{\mathsf{Setup}}\xspace}
\newcommand{\KGen}{\ensuremath{\mathsf{KeyGen}}\xspace}
\newcommand{\Equivocate}{\ensuremath{\mathsf{Equivocate}}\xspace}
\newcommand{\SimSetup}{\ensuremath{\mathsf{SimSetup}}\xspace}
\newcommand{\Stretch}{\ensuremath{\mathsf{Stretch}}\xspace}
\newcommand{\Trapdoor}{\ensuremath{\mathsf{Trapdoor}}\xspace}

%\newcommand{\pk}{\ensuremath{\mathsf{pk}}\xspace}
%\newcommand{\sk}{\ensuremath{\mathsf{sk}}\xspace}
\newcommand{\ek}{\ensuremath{\mathsf{ek}}\xspace}
\newcommand{\vk}{\ensuremath{\mathsf{vk}}\xspace}
\newcommand{\pvk}{\ensuremath{\mathsf{pvk}}\xspace}
\newcommand{\PVK}{\ensuremath{\mathsf{PVK}}\xspace}
\newcommand{\hk}{\ensuremath{\mathsf{hk}}\xspace}
%\newcommand{\aux}{\ensuremath{{\mathsf{aux}}}\xspace}
\newcommand{\crs}{\ensuremath{{\mathsf{crs}}}\xspace}
\newcommand{\param}{\ensuremath{{\mathsf{par}}}\xspace}
\newcommand{\trap}{\ensuremath{\mathcal{T}}\xspace}
\newcommand{\eps}{\varepsilon}

%--------------------------------------------------------
% Hard problems
%--------------------------------------------------------

\newcommand{\hardprobfont}[1]{\texorpdfstring{\ensuremath{\textsf{#1}}}{#1}}
\newcommand{\kLIN}{\ensuremath{k\text{-}\mathsf{Lin}}\xspace}
\newcommand{\SEDL}{\hardprobfont{SEDL}\xspace}
\newcommand{\DL}{\hardprobfont{DL}\xspace}
\newcommand{\DDH}{\hardprobfont{DDH}\xspace}
\newcommand{\kerDH}{\hardprobfont{kerDH}\xspace}
\newcommand{\kernel}{\mathsf{ker}\xspace}
\newcommand{\DHP}{\hardprobfont{DH}\xspace}
\newcommand{\DLin}{\hardprobfont{DLin}\xspace}
\newcommand{\XDH}{\hardprobfont{XDH}\xspace}
\newcommand{\CDH}{\hardprobfont{CDH}\xspace}
\newcommand{\LWE}{\hardprobfont{LWE}\xspace}
\newcommand{\SXDH}{\hardprobfont{SXDH}\xspace}
\newcommand{\DCR}{\hardprobfont{DCR}\xspace}
\newcommand{\dlog}{\ensuremath{\mathsf{dlog}}\xspace}

%--------------------------------------------------------
% Various
%--------------------------------------------------------

\newcommand{\map}{\ensuremath{\mathsf{map}}\xspace}
\newcommand{\mode}{\mathsf{mode}}
\newcommand{\token}{\ensuremath{\mathsf{token}}\xspace}
\newcommand{\inp}{\ensuremath{\mathsf{in}}\xspace}
\newcommand{\outp}{\ensuremath{\mathsf{out}}\xspace}
\newcommand{\circuit}{\ensuremath{\mathcal{C}}\xspace}
\newcommand{\size}[1]{\ensuremath{\left\vert #1 \right\vert}\xspace}
\newcommand{\myand}{\ensuremath{\mathsf{and}}\xspace}
\newcommand{\myxor}{\ensuremath{\mathsf{xor}}\xspace}
%\newcommand{\xor}{\mathbin{\mathsf{xor}}}
\newcommand{\mynot}{\ensuremath{\mathsf{not}}\xspace}
%\newcommand{\Input}{\ensuremath{\mathsf{Input}}\xspace}
%\newcommand{\compind}{\approx_c}


%--------------------------------------------------------
% Double angle brackets
%--------------------------------------------------------

\makeatletter
\DeclareFontFamily{OMX}{MnSymbolE}{}
\DeclareSymbolFont{MnLargeSymbols}{OMX}{MnSymbolE}{m}{n}
\SetSymbolFont{MnLargeSymbols}{bold}{OMX}{MnSymbolE}{b}{n}
\DeclareFontShape{OMX}{MnSymbolE}{m}{n}{
    <-6>  MnSymbolE5
   <6-7>  MnSymbolE6
   <7-8>  MnSymbolE7
   <8-9>  MnSymbolE8
   <9-10> MnSymbolE9
  <10-12> MnSymbolE10
  <12->   MnSymbolE12
}{}
\DeclareFontShape{OMX}{MnSymbolE}{b}{n}{
    <-6>  MnSymbolE-Bold5
   <6-7>  MnSymbolE-Bold6
   <7-8>  MnSymbolE-Bold7
   <8-9>  MnSymbolE-Bold8
   <9-10> MnSymbolE-Bold9
  <10-12> MnSymbolE-Bold10
  <12->   MnSymbolE-Bold12
}{}

\let\llangle\@undefined
\let\rrangle\@undefined
\DeclareMathDelimiter{\llangle}{\mathopen}%
                     {MnLargeSymbols}{'164}{MnLargeSymbols}{'164}
\DeclareMathDelimiter{\rrangle}{\mathclose}%
                     {MnLargeSymbols}{'171}{MnLargeSymbols}{'171}
\makeatother

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../main"
%%% End:
